<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr">
<head>
<title>BloBloCar Map 2</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<script type="text/javascript">
	//création de la carte
	function initialiser() {
		var latlng = new google.maps.LatLng(48.5734053, 7.7521113);
		var options = {
			center : latlng,
			zoom : 12,
			mapTypeId : google.maps.MapTypeId.ROADMAP
		};
		var carte = new google.maps.Map(document.getElementById("carte"),
				options);

		//création des cercles

		var table = liste;

		for (var i = 0; i < table.length; i++) {
			
			var address = table[i].adresse;
			var mobility = table[i].perimetre;
			var contentString = table[i].nom +' '+ table[i].prenom +"<br />"+ table[i].adresse +"<br />"+ table[i].mail;
			
			var geocoder = new google.maps.Geocoder();
			geocoder.geocode({'address' : address}, function(results, status) {
				if (status == google.maps.GeocoderStatus.OK) {
					var latitude = results[0].geometry.location.lat();
					var longitude = results[0].geometry.location.lng();
					var cercle = new google.maps.Circle({
						map : carte,
						center : new google.maps.LatLng(latitude, longitude),
						radius: 1000*(mobility)
					});
					var marqueur = new google.maps.Marker({
					    position: new google.maps.LatLng(latitude, longitude),
					    map: carte
					});
					var info = new google.maps.InfoWindow({
					    content: contentString,
					    size: new google.maps.Size(100, 100)
					});
					google.maps.event.addListener(marqueur, 'click', function(){
						info.open(carte, marqueur);
					});
				};
			});
		};
	};
</script>
<script async defer
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBpv8pCGZg7V6G5nU8vYe7qIZcksVqf62k&callback=initialiser">
	
</script>
</head>

<body onload="initialiser()">
	<div id="carte" style="width: 100%; height: 100%"></div>
</body>
</html>